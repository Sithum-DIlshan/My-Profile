<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bootstrap</title>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link href="assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <script crossorigin="anonymous" src="https://kit.fontawesome.com/a439b50eb0.js"></script>
    <style>
        #item {
            display: none;
        }

        #customer {
            display: none;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
        <img alt="" class="d-inline-block align-text-top me-5" height="70" src="assets/logo_transparent_background.png"
             width="90">

        <a class="navbar-brand" href="#">Blue Ridge</a>
        <button aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"
                class="navbar-toggler shadow-none"
                data-bs-target="#navbarNav" data-bs-toggle="collapse" type="button">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a aria-current="page" class="nav-link" href="#" id="load-home">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" id="load-orders">Orders</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" id="load-items">Items</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" id="load-customers">Customers</a>
                </li>
                <li class="nav-item">
                    <div class="dropdown">
                        <button aria-expanded="false" class="btn dropdown-toggle" data-bs-toggle="dropdown"
                                id="dropdownMenuButton1" type="button">
                            Dropdown button
                        </button>
                        <ul aria-labelledby="dropdownMenuButton1" class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">Action</a></li>
                            <li><a class="dropdown-item" href="#">Another action</a></li>
                            <li><a class="dropdown-item" href="#">Something else here</a></li>
                        </ul>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</nav>


<div class="container-fluid col-12 mt-3" id="invoice">
    <div class="row bg-secondary bg-opacity-10">
        <div class="col-4 bg-light">
            <!--<div class="mb-3">
                <label for="recipient-name" class="col-form-label">Recipient:</label>
                <input type="text" class="form-control" id="recipient-name">
            </div><div class="mb-3">
                <label for="recipient-name" class="col-form-label">Recipient:</label>
                <input type="text" class="form-control" id="recipient-name">
            </div><div class="mb-3">
                <label for="recipient-name" class="col-form-label">Recipient:</label>
                <input type="text" class="form-control" id="recipient-name">
            </div><div class="mb-3">
                <label for="recipient-name" class="col-form-label">Recipient:</label>
                <input type="text" class="form-control" id="recipient-name">
            </div>-->
            <div class="container">
                <div class="row bg-primary h-25">
                    <div class="modal-header">
                        <h5 class="modal-title text-light" id="exampleModalLabel">Invoice Details</h5>
                    </div>
                </div>
                <div class="row">
                    <div class="col-6">
                        <label class="col-form-label" for="orderId">Order Id:</label>
                        <input class="form-control" id="orderId" type="text" value="O-001">
                    </div>
                    <div class="col-6">
                        <label class="col-form-label" for="txtDate">Date :</label>
                        <input class="form-control" id="txtDate" type="date">
                    </div>
                </div>
                <div class="row">
                    <!--
                                        <div class="col-6">
                    -->
                    <!--  <label for="recipient-name" class="col-form-label">Recipient:</label>
                      <input type="text" class="form-control" id="recipient-name">-->
                    <div class="col-6">
                        <div class="form-group">
                            <label class="col-form-label" for="selectCusID">Customer :</label>
                            <select class="form-control" id="selectCusID">
                                <option disabled hidden selected value="h">Select-Customer</option>
                            </select>
                            <span class="control-error"
                                  id="cus-empty-error"></span>
                        </div>
                    </div>
                    <!--</div>-->
                    <div class="col-6">
                        <label class="col-form-label" for="recipient-name">Customer Id:</label>
                        <input class="form-control" id="invoiceCusId" readonly type="text">
                    </div>
                </div>
                <div class="row">
                    <div class="col-6">
                        <label class="col-form-label" for="recipient-name">Customer Name:</label>
                        <input class="form-control" id="invoiceCusName" readonly type="text">
                    </div>
                    <div class="col-6">
                        <label class="col-form-label" for="recipient-name">Customer Salary:</label>
                        <input class="form-control" id="invoiceCusSalary" readonly type="text">
                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        <label class="col-form-label" for="recipient-name">Customer Address:</label>
                        <input class="form-control" id="invoiceCusAddress" readonly type="text">
                    </div>
                </div>
            </div>
        </div>
        <div class="col-5 bg-light">
            <div class="container">
                <div class="row bg-primary h-25">
                    <div class="modal-header">
                        <h5 class="modal-title text-light" id="exampleModalLabel">Item Select</h5>
                    </div>
                </div>
                <div class="row">
                    <div class="col-6">
                        <div class="dropdown">
                            <label class="col-form-label" for="selectItemID">Select Item:</label>
                            <select class="form-control" id="selectItemID">
                                <option disabled hidden selected value="h">Select-Item</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-6">
                        <label class="col-form-label" for="recipient-name">Code:</label>
                        <input class="form-control" id="invoiceItemCode" readonly type="text">
                    </div>
                </div>
                <div class="row">
                    <div class="col-4">
                        <!--  <label for="recipient-name" class="col-form-label">Recipient:</label>
                          <input type="text" class="form-control" id="recipient-name">-->
                        <label class="col-form-label" for="recipient-name">Item Name:</label>
                        <input class="form-control" id="invoiceItemName" readonly type="text">
                    </div>
                    <div class="col-4">
                        <label class="col-form-label" for="recipient-name">Price:</label>
                        <input class="form-control" id="invoiceItemPrice" readonly type="text">
                    </div>
                    <div class="col-4">
                        <label class="col-form-label" for="recipient-name">Qty On hand:</label>
                        <input class="form-control" id="invoiceItemQtyOnHand" readonly type="text">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <label class="col-form-label" for="recipient-name">Order Qty:</label>
                        <input class="form-control" id="invoiceItemOrderQty" type="text">
                    </div>
                </div>
                <div class="row justify-content-end mt-4">
                    <div class="col-3">
                        <button class="btn btn-primary btn-sm" id="addItemToOrder" type="button">Add Item</button>
                    </div>
                </div>
            </div>

        </div>
        <div class="col-3 bg-light">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <div class="alert alert-info" role="alert">
                            <p class="p-0 m-0" id="total"></p>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <div class="alert alert-info" role="alert">
                            <p class="p-0 m-0" id="subTotal"></p>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-6">
                        <label class="col-form-label" for="recipient-name">Cash:</label>
                        <input class="form-control" id="invoiceCash" type="text">
                    </div>
                    <div class="col-6">
                        <label class="col-form-label" for="recipient-name">Discount:</label>
                        <input class="form-control" id="invoiceDiscount" type="text">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <label class="col-form-label" for="recipient-name">Balance:</label>
                        <input class="form-control" id="invoiceBalance" readonly type="text">
                    </div>
                </div>
                <div class="row justify-content-center">
                    <div class="col-4">
                        <button class="btn btn-success btn-sm mt-3" id="purchase" type="button">Purchase</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row bg-secondary bg-opacity-10 mt-3">
        <div class="col-12 overflow-auto" style="max-height: 150px">
            <table class="table caption-top ">
                <thead class="thead-dark">
                <tr>
                    <th scope="col">Item Id</th>
                    <th scope="col">Name</th>
                    <th scope="col">Price</th>
                    <th scope="col">Quantity</th>
                </tr>
                </thead>
                <tbody id="tableCart">

                </tbody>
            </table>
        </div>
    </div>
</div>
<div class="container-fluid col-10 mt-4" id="customer">

    <div class="container">
        <div class="row justify-content-sm-between mb-5">
            <div class="col-12 bg-secondary bg-opacity-25" style="max-height: 33px">
                <h1 class="fs-3 mb-3">Customer<i class="fas fa-user-friends"></i></h1>
            </div>
        </div>
        <nav aria-label="breadcrumb" style="--bs-breadcrumb-divider: '>';">
            <ol class="breadcrumb">
                <li class="breadcrumb-item "><a href="#" style="text-decoration: none">Home</a></li>
                <li aria-current="page" class="breadcrumb-item active">Customer</li>
            </ol>
        </nav>
        <div class="row justify-content-sm-between bg-secondary bg-opacity-10">
            <div class="col-6">
                <form>
                    <div class="mb-3">
                        <label class="form-label" for="exampleInputEmail1">Search Customer</label>
                        <input aria-describedby="emailHelp" class="form-control" id="exampleInputEmail1"
                               placeholder="Input Name/NIC"
                               type="email">
                    </div>
                    <button class="btn btn-primary btn-sm" type="submit">Submit</button>
                    <div class="dropdown d-inline">
                        <button aria-expanded="false" class="btn border dropdown-toggle btn-sm shadow-none"
                                data-bs-toggle="dropdown"
                                id="dropdownMenuButton2" type="button">
                            Name
                        </button>
                        <ul aria-labelledby="dropdownMenuButton2" class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">Action</a></li>
                            <li><a class="dropdown-item" href="#">Another action</a></li>
                            <li><a class="dropdown-item" href="#">Something else here</a></li>
                        </ul>
                    </div>
                </form>
                <div aria-label="Basic example" class="btn-group mt-3" role="group">
                    <button class="btn btn-danger btn-sm shadow-none" type="button">Delete</button>
                    <button class="btn btn-info btn-sm text-light shadow-none" type="button">Details</button>
                    <button class="btn btn-dark btn-sm shadow-none" id="clearCustomers" type="button">Clear</button>
                </div>
            </div>
            <div class="col-3">
                <!--<button type="button" class="btn btn-outline-success btn-sm">Add Customer</button>
            -->
                <button class="btn btn-outline-success btn-sm shadow-none" data-bs-target="#exampleModal"
                        data-bs-toggle="modal"
                        data-bs-whatever="@mdo" type="button">Add Customer
                </button>
                <button class="btn btn-outline-dark btn-sm shadow-none" type="button">View All</button>

                <div aria-hidden="true" aria-labelledby="exampleModalLabel" class="modal fade" id="exampleModal"
                     tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Add Customer</h5>
                                <button aria-label="Close" class="btn-close shadow-none" data-bs-dismiss="modal"
                                        type="button"></button>
                            </div>
                            <div class="modal-body">
                                <form>
                                    <div class="mb-3">
                                        <label class="col-form-label" for="recipient-name">Customer
                                            ID:</label>
                                        <input class="form-control input-group-sm" id="cus-id" type="text">
                                        <p><small class="text-danger pl-1" id="lblcusid"></small></p>

                                        <label class="col-form-label" for="recipient-name">Customer
                                            Name:</label>
                                        <input class="form-control" id="cus-name" type="text">
                                        <p><small class="text-danger pl-1" id="lblcusname"></small></p>

                                        <label class="col-form-label" for="recipient-name">Customer
                                            Address:</label>
                                        <input class="form-control" id="cus-address" type="text">
                                        <p><small class="text-danger pl-1" id="lblcusaddress"></small></p>

                                        <label class="col-form-label" for="recipient-name">Customer
                                            Salary:</label>
                                        <input class="form-control" id="cus-salary" type="text">
                                        <p><small class="text-danger pl-1" id="lblcussalary"></small></p>

                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-secondary btn-sm shadow-none" data-bs-dismiss="modal"
                                        type="button">Close
                                </button>
                                <button class="btn btn-primary btn-sm shadow-none" id="saveCustomer" type="button">
                                    Save
                                </button>
                                <button class="btn btn-info btn-sm shadow-none" type="button">Renew</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row bg-secondary bg-opacity-10">
            <div class="col-12 overflow-auto mt-5" style="max-height: 200px">
                <table class="table caption-top table-hover">
                    <thead class="thead-dark">
                    <tr>
                        <th scope="col">Customer Id</th>
                        <th scope="col">Name</th>
                        <th scope="col">Address</th>
                        <th scope="col">Salary</th>
                    </tr>
                    </thead>
                    <tbody id="customerTable">


                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<div class="container-fluid col-10 mt-4" id="item">

    <div class="container">
        <div class="row justify-content-sm-between mb-5">
            <div class="col-12 bg-secondary bg-opacity-25" style="max-height: 33px">
                <h1 class="fs-3 mb-3">Item<i class="fas fa-shopping-bag"></i></h1>
            </div>
        </div>
        <nav aria-label="breadcrumb" style="--bs-breadcrumb-divider: '>';">
            <ol class="breadcrumb">
                <li class="breadcrumb-item "><a href="#" style="text-decoration: none">Home</a></li>
                <li aria-current="page" class="breadcrumb-item active">Items</li>
            </ol>
        </nav>
        <div class="row justify-content-sm-between bg-secondary bg-opacity-10">
            <div class="col-6">
                <form>
                    <div class="mb-3">
                        <label class="form-label" for="exampleInputEmail1">Search Items</label>
                        <input aria-describedby="emailHelp" class="form-control" id="itemSearchField"
                               placeholder="Input Item Name/Code"
                               type="email">
                    </div>
                    <button class="btn btn-primary btn-sm" type="submit">Search</button>
                    <div class="dropdown d-inline">
                        <button aria-expanded="false" class="btn border dropdown-toggle btn-sm shadow-none"
                                data-bs-toggle="dropdown"
                                id="dropdownMenuButton2" type="button">
                            Name
                        </button>
                        <ul aria-labelledby="dropdownMenuButton2" class="dropdown-menu">
                            <li><a class="dropdown-item" href="#">Action</a></li>
                            <li><a class="dropdown-item" href="#">Another action</a></li>
                            <li><a class="dropdown-item" href="#">Something else here</a></li>
                        </ul>
                    </div>
                </form>
                <div aria-label="Basic example" class="btn-group mt-3" role="group">
                    <button class="btn btn-danger btn-sm shadow-none" type="button">Delete</button>
                    <button class="btn btn-info btn-sm text-light shadow-none" type="button">Details</button>
                    <button class="btn btn-dark btn-sm shadow-none" type="button">Clear</button>
                </div>
            </div>
            <div class="col-3">
                <!--<button type="button" class="btn btn-outline-success btn-sm">Add Customer</button>
            -->
                <button class="btn btn-outline-success btn-sm shadow-none" data-bs-target="#exampleModal2"
                        data-bs-toggle="modal"
                        data-bs-whatever="@mdo" type="button">Add Item
                </button>
                <button class="btn btn-outline-dark btn-sm shadow-none" type="button">View All</button>

                <div aria-hidden="true" aria-labelledby="exampleModalLabel" class="modal fade" id="exampleModal2"
                     tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel2">Add Item</h5>
                                <button aria-label="Close" class="btn-close shadow-none" data-bs-dismiss="modal"
                                        type="button"></button>
                            </div>
                            <div class="modal-body">
                                <form>
                                    <div class="mb-3">
                                        <label class="col-form-label " for="recipient-name">Item ID:</label>
                                        <input class="form-control input-group-sm" id="Item-id" type="text">
                                        <p><small class="text-danger pl-1" id="lblitemid"></small></p>

                                        <label class="col-form-label" for="recipient-name">Item Name:</label>
                                        <input class="form-control" id="item-name" type="text">
                                        <p><small class="text-danger pl-1" id="lblitemname"></small></p>

                                        <label class="col-form-label" for="recipient-name">Item Price:</label>
                                        <input class="form-control" id="item-price" type="text">
                                        <p><small class="text-danger pl-1" id="lblitemprice"></small></p>

                                        <label class="col-form-label" for="recipient-name">Item Quantity:</label>
                                        <input class="form-control" id="item-qty" type="text">
                                        <p><small class="text-danger pl-1" id="lblitemqty"></small></p>

                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-secondary btn-sm shadow-none" data-bs-dismiss="modal"
                                        type="button">Close
                                </button>
                                <button class="btn btn-primary btn-sm shadow-none" id="save-item" type="button">Save
                                </button>
                                <button class="btn btn-info btn-sm shadow-none" type="button">Renew</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row bg-secondary bg-opacity-10">
            <div class="col-12 overflow-auto mt-5" style="max-height: 200px">
                <table class="table caption-top table-hover">
                    <thead class="thead-dark">
                    <tr>
                        <th scope="col">Item Id</th>
                        <th scope="col">Name</th>
                        <th scope="col">Price</th>
                        <th scope="col">Quantity</th>
                    </tr>
                    </thead>
                    <tbody id="itemTable">


                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>


<script src="assets/bootstrap/js/bootstrap.min.js"></script>
<script src="assets/jquery/jquery-3.6.0.min.js"></script>
<script src="db/DB.js"></script>
<script src="controller/CustomerController.js"></script>
<script src="controller/ItemController.js"></script>
<script src="controller/OrderController.js"></script>
<script src="model/Customer.js"></script>
<script src="model/Item.js"></script>
<script src="model/Cart.js"></script>
<script src="model/OrderDetails.js"></script>
<script src="model/Order.js"></script>
<script>
    document.getElementById("load-customers").addEventListener("click", function () {
        document.getElementById("invoice").style.display = "none";
        document.getElementById("item").style.display = "none";
        document.getElementById("customer").style.display = "block";
    })
    document.getElementById("load-items").addEventListener("click", function () {
        document.getElementById("invoice").style.display = "none";
        document.getElementById("item").style.display = "block";
        document.getElementById("customer").style.display = "none";
    })
    document.getElementById("load-home").addEventListener("click", function () {
        document.getElementById("invoice").style.display = "block";
        document.getElementById("item").style.display = "none";
        document.getElementById("customer").style.display = "none";
    })

    /*  const cusIDRegEx = /^(C00-)[0-9]{1,3}$/;
      const cusNameRegEx = /^[A-z ]{5,20}$/;
      const cusAddressRegEx = /^[0-9/A-z. ,]{7,}$/;
      const cusSalaryRegEx = /^[0-9]{1,}[.]?[0-9]{1,2}$/;*/


    $("#saveCustomer").click(function () {
        /*let customerID = $("#cus-id").val();
        let customerName = $("#cus-name").val();
        let customerAddress = $("#cus-address").val();
        let customerSalary = $("#cus-salary").val();*/
        var customer = new Customer($("#cus-id").val(), $("#cus-name").val(), $("#cus-address").val(), $("#cus-salary").val());
        /*
                console.log(customer.id);
        */
        if (checkCustomerExists(customer.id)) {
            $("#cus-id").css('border', '2px solid red');
            $("#lblcusid").text("Cus ID Already Exists Try Another One");
            let res = confirm("Try Again");
            if (res) {
                $("#cus-id").val('');
            }
        } else {
            saveCustomer(customer);
            clearAll();
        }

    });

    $("#clearCustomers").click(function () {
        clearCustomers();
    });

    $('#cus-id,#cus-name,#cus-address,#cus-salary').on('keydown', function (eventOb) {
        if (eventOb.key == "Tab") {
            eventOb.preventDefault(); // stop execution of the button
        }
    });

    $(document).ready(function () {
        /*loadAllCustomerIds();*/
        /*alert("ddd");*/
        /*$("#selectCusID").append($('<option></option>').attr('value',"key").text("Loaded"));*/
        loadAllCustomerIds();
        loadAllItemIds();
        $("#total").text('Total Rs: 0');
        $("#subTotal").text('SubTotal Rs: 0');
        $("#save-item").attr('disabled', true);
        $("#saveCustomer").attr('disabled', true);
    });

    $("#selectCusID").change(function () {
        $("#invoiceCusId").val($("#selectCusID :selected").text());

        var obj = searchCustomer($("#invoiceCusId").val());
        if (obj != null) {
            $("#invoiceCusName").val(obj.name);
            $("#invoiceCusSalary").val(obj.salary);
            $("#invoiceCusAddress").val(obj.address);

        }

    });


    /* $('#cus-id,#cus-name,#cus-address,#cus-salary').on('keydown', function (eventOb) {
         if (eventOb.key == "Tab") {
             eventOb.preventDefault(); // stop execution of the button
         }
     });

     $('#cus-id,#cus-name,#cus-address,#cus-salary').on('blur', function () {
         cusformValid();
     });

     //focusing events
     $("#cus-id").on('keyup', function (e) {
         cusbtnenabledisable();
         if (e.key === "Enter") {
             cuscheckvalid();
         }
     });
     $("#cus-name").on('keyup', function (e) {
         cusbtnenabledisable();
         if (e.key === "Enter") {
             cuscheckvalid();
         }
     });
     $("#cus-address").on('keyup', function (e) {
         cusbtnenabledisable();
         if (e.key === "Enter") {
             cuscheckvalid();
         }
     });
     $("#cus-salary").on('keyup', function (e) {
         cusbtnenabledisable();
         if (e.key === "Enter") {
             cuscheckvalid();
         }
     });

     // focusing events end

     function cusformValid() {
         var cusID = $("#cus-id").val();
         $("#cus-id").css('border', '2px solid green');
         $("#lblcusid").text("");
         if (cusIDRegEx.test(cusID)) {
             var cusName = $("#cus-name").val();
             if (cusNameRegEx.test(cusName)) {
                 $("#cus-name").css('border', '2px solid green');
                 $("#lblcusname").text("");
                 var cusAddress = $("#cus-address").val();
                 if (cusAddressRegEx.test(cusAddress)) {
                     var cusSalary = $("#cus-salary").val();
                     var resp = cusSalaryRegEx.test(cusSalary);
                     $("#cus-address").css('border', '2px solid green');
                     $("#lblcusaddress").text("");
                     if (resp) {
                         $("#cus-salary").css('border', '2px solid green');
                         $("#lblcussalary").text("");
                         return true;
                     } else {
                         $("#cus-salary").css('border', '2px solid red');
                         $("#lblcussalary").text("Cus Salary is a required field : Pattern 100.00 or 100");
                         return false;
                     }
                 } else {
                     $("#cus-address").css('border', '2px solid red');
                     $("#lblcusaddress").text("Cus Address is a required field : Mimum 7");
                     return false;
                 }
             } else {
                 $("#cus-name").css('border', '2px solid red');
                 $("#lblcusname").text("Cus Name is a required field : Mimimum 5, Max 20, Spaces Allowed");
                 return false;
             }
         } else {
             $("#cus-id").css('border', '2px solid red');
             $("#lblcusid").text("Cus ID is a required field : Pattern C00-000");
             return false;
         }
     }

     function cuscheckvalid() {
         var cusID = $("#cus-id").val();
         if (cusIDRegEx.test(cusID)) {
             $("#cus-name").focus();
             var cusName = $("#cus-name").val();
             if (cusNameRegEx.test(cusName)) {
                 $("#cus-address").focus();
                 var cusAddress = $("#cus-address").val();
                 if (cusAddressRegEx.test(cusAddress)) {
                     $("#cus-salary").focus();
                     var cusSalary = $("#cus-salary").val();
                     var resp = cusSalaryRegEx.test(cusSalary);
                     if (resp) {
                         let res = confirm("Do you really need to add this Customer..?");
                         if (res) {
                             saveCustomer();
                             clearAll();
                         }
                     } else {
                         $("#cus-salary").focus();
                     }
                 } else {
                     $("#cus-address").focus();
                 }
             } else {
                 $("#cus-name").focus();
             }
         } else {
             $("#cus-id").focus();
         }
     }

     function cusbtnenabledisable() {
         let b = cusformValid();
         if (b) {
             $("#saveCustomer").attr('disabled', false);
         } else {
             $("#saveCustomer").attr('disabled', true);
         }
     }
 */

    $("#save-item").click(function () {
        var item = new Item($("#Item-id").val(), $("#item-name").val(), $("#item-price").val(), $("#item-qty").val());

        if (checkItemExists(item.id)) {
            $("#Item-id").css('border', '2px solid red');
            $("#lblitemid").text("Item ID Already Exists Try Another One");
            let res = confirm("Try Again");
            if (res) {
                $("#Item-id").val('');
            }
        } else {
            saveitem(item);
        }

    });

    $('#Item-id,#item-name,#item-price,#item-qty').on('keydown', function (eventOb) {
        if (eventOb.key == "Tab") {
            eventOb.preventDefault(); // stop execution of the button
        }
    });

    $("#selectItemID").change(function () {
        $("#invoiceItemCode").val($("#selectItemID :selected").text());

        var obj = searchItem($("#invoiceItemCode").val());
        if (obj != null) {
            $("#invoiceItemName").val(obj.name);
            $("#invoiceItemPrice").val(obj.price);
            $("#invoiceItemQtyOnHand").val(obj.qty);
        }
    });

    let total = 0;
    let subTotal = 0;

    $("#addItemToOrder").click(function () {
        if (itemDB.length >= 0 && customerDB.length >= 0) {
            if ($("#invoiceItemQtyOnHand").val() > $("#invoiceItemOrderQty").val()) {
                var cart = new Cart($("#invoiceItemCode").val(), $("#invoiceItemName").val(), $("#invoiceItemPrice").val(), $("#invoiceItemOrderQty").val())
                addItemToCart(cart);
                var price = parseFloat($("#invoiceItemPrice").val());
                var qty = parseFloat($("#invoiceItemOrderQty").val());
                total = total + (price * qty);
                subTotal = total;
                $("#total").text('Total Rs: ' + total);
                $("#subTotal").text('SubTotal Rs: ' + subTotal);
            } else {
                alert("Out of stock");
            }
        } else {
            alert("Done");
        }
    });

    $("#invoiceCash").on('keyup', function (e) {
        if (!$("#total").is(':empty')) {
            /* var cash = parseFloat($("#invoiceCash").val());
             var balance = subTotal-cash;
             $("#invoiceBalance").val(balance);*/
            if (subAftrDisc != 0) {
                calculateBalance(subAftrDisc);
            } else {
                calculateBalance(subTotal);
            }

        }
    });

    function calculateBalance(sub) {
        var cash = parseFloat($("#invoiceCash").val());
        var balance = cash - sub;
        $("#invoiceBalance").val(balance);
    }

    var subAftrDisc = 0;
    $("#invoiceDiscount").on('keyup', function (e) {
        if (!$("#total").is(':empty')) {
            /* var cash = parseFloat($("#invoiceCash").val());
             var balance = subTotal-cash;
             $("#invoiceBalance").val(balance);*/
            if (!$("#invoiceDiscount").val()) {
                $("#subTotal").text('SubTotal Rs: ' + subTotal);
            } else {
                var dis = parseFloat($("#invoiceDiscount").val());
                subAftrDisc = subTotal - subTotal * dis / 100;
                $("#subTotal").text('SubTotal Rs: ' + subAftrDisc);
                calculateBalance(subAftrDisc);
            }
        }
    });

    $("#purchase").click(function () {
        let balance= parseFloat($("#invoiceBalance").val());
        if ($("#invoiceBalance").val().length != 0 && balance == 0) {
            let sub = parseFloat($("#subTotal").text().substr(13));
            let order = new Order($("#orderId").val(), $("#txtDate").val(), $("#invoiceCusId").val(), sub);
            placeOrder(order);
            var oID = incrementOrderId(order.oId);
            $("#orderId").val(oID);
            clearInputsAndTotals();
        }else {
            alert("insufficient credits, try again");
        }
    });

    $("#orderId").on('keyup', function (e) {
        if (e.key == "Enter"){
            var searchOrder1 = searchOrder($("#orderId").val());
            if (searchOrder1 != null){
                $("#txtDate").val(searchOrder1.date);
                $("#selectCusID").val(searchOrder1.cusId);
                $("#invoiceCusId").val(searchOrder1.cusId);
                let customer1 = searchCustomer(searchOrder1.cusId);

                $("#invoiceCusName").val(customer1.name);
                $("#invoiceCusSalary").val(customer1.salary);
                $("#invoiceCusAddress").val(customer1.address);
                let subTotal1 = searchOrder1.subTotal;
                $("#subTotal").text('SubTotal Rs: ' + subTotal1);
            }
        }
    });

    $("#orderId").on('keyup', function () {
        oIdValid();
    });



</script>
</body>
</html>